<!DOCTYPE html>
<head>
	<html lang="pl">
	<meta charset="utf-8" />
	<link href="https://fonts.googleapis.com/css?family=Roboto+Slab" rel="stylesheet">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<link type="text/css" rel="stylesheet" href="style.css">
	<title>Profile Page</title>
</head>
<body>
<div id="wraphold">
	<div class="header">
		<div id="flex1">
			<div id="logo"></div>
			<form action>
			<div id="search-container" class="tile"  style="float:left;" >
			<input id="searchInput" onfocusout="BtnHide()" onfocus="BtnDisplay()" autocomplete="off"/>
			<div id="searchResults-container">
			</div>
			</div>
			<div id="flex2">
			<input type="button"/>
			<input type="button"/>
			<input type="button"/>
			
			<input id="Logout" value=""type="button"/>
	
	</div>
	</div><input id="searchBtn" type="button" value="Search"/><br>
				<div id="searchResults-container">
				</div>

				</div></form>
			</div>				
	<div class="centered">
		<h2>Edit Your Profile</h2>
		<form action>
		<div id="profile-container" class="tile" >
		<div class="section"><form>
		<table><tr><h3>Edit your name:</h3></tr>
			<tr><td>First Name: </td><td><input id="name"/><br></td></tr>
			<tr><td>Second Name: </td><td><input id="name2"/><br></td></tr>
			<tr><td></td><td><input type="button" value="Save"></td></tr>
		</table></form>
		</div>
		<div class="section"><form>
		<table><tr><h3>Edit your password:</h3></tr>
			<tr><td>Current password: </td><td><input id="oldPass"/><br></td></tr>
			<tr><td>New password: </td><td><input id="newPass"/><br></td></tr>
			<tr><td>Repeat new password: </td><td><input id="newPassRepeat"/><br></td></tr>
			<tr><td></td><td><input type="button" value="Save"></td></tr>
		</table></form>
		</div>
		<div class="section"><form>
		<table><tr><h3>Edit your birth date:</h3></tr>
			<tr><td>Birth Date: </td><td><input id="dateofbirth"/><br></td></tr>
			<tr><td></td><td><input type="button" value="Save"></td></tr>
		</table></form>
		</div>
		<div class="section"><form>
		<table><tr><h3>Edit your address:</h3></tr>
			<tr><td>Adress: </td><td><input id="address"/><br></td></tr>
			<tr><td>Post-code and City :</td><td><input id="address2"/><br></td></tr>
			<tr><td>Country: </td><td><input id="country"/><br></td></tr>
			<tr><td></td><td><input type="button" value="Save"></td></tr>
		</table></form>
		</div>
			"jobexperience": [
			{"company":"Acaisoft", "from":"12-12-2017", "to":"1-1-2018"},
			{"company":"Google", "from":"12-12-2017", "to":"1-1-2018"},
			{"company":"Microsoft", "from":"12-12-2017", "to":"1-1-2018"}
			]<div class="section"><form>
			<table><tr><h3>Add job experience:</h3></tr>
				<tr><td>Company name: </td><td><input id="companyName"/><br></td></tr>
				<tr><td>From date (dd-mm-yyyy):</td><td><input id="companyFrom"/><br></td></tr>
				<tr><td>To date (dd-mm-yyyy): </td><td><input id="companyTo"/><br></td></tr>
				<tr><td></td><td><input type="button" value="+ Add"></td></tr>
			</table></form></div>
			<div id="jobexperiencelist">
				<div class="objectInArray">
					<div class="line"><span class="key"> Company Name:</span><span class="value">"acaisfot"</span></div>
					<div class="line"><span class="key">From:</span><span class="value">"1-11-11111"</span></div>
					<div class="line"><span class="key">Name:</span><span class="value">"acaisfot"</span></div>
				</div>
			</div>

			<script>
				

                var jsonProfile = {
                    "uid":2,
                    "name": "Krzysztof",
                    "name2": "Widacki",
                    "dateofbirth": "19-04-1998",
                    "birthofaccount":"21-04-1998",
                    "email": "krzysztofwidacki@gmail.com",
                    "tel": "123456789",
                    "address": "Słoneczna 15",
                    "address2": "Warsaw 02-540",
                    "country":"Poland",
                    "jobexperience": [
                        {"company":"Acaisoft", "from":"12-12-2017", "to":"1-1-2018"},
                        {"company":"Google", "from":"12-12-2017", "to":"1-1-2018"},
                        {"company":"Microsoft", "from":"12-12-2017", "to":"1-1-2018"}
                    ],
                    "schools": [
                        {"name":"Wiśniowa",
                            "from":"1-12-1212",
                            "to":"2-12-1212"},
                        {"name":"Staffa nr 1",
                            "from":"1-12-1212",
                            "to":"2-12-1212"},
                        {"name":"Generic School 3",
                            "from":"2-11-1318",
                            "to":"2-1-1290"}
                    ],
                    "skills": [
                        "breathing", "holding two handed swords with one hand"
                    ],
                    "acomplishments":{
                        "interests": [
                            "Films", "Bikes"
                        ],
                        "projects":[
                            {
                                "name":"google self driving cars",
                                "ended":"1-1-2012"
                            },
                            {
                                "name":"cloudlanes",
                                "ended":"3-2-2013"
                            }
                        ],
                        "courses":[
                            {
                                "name":"ccna1course",
                                "ended":"1-1-2017"
                            },
                            {
                                "name":"ccna2course",
                                "ended":"2-2-2017"
                            }
                        ],
                        "certificates":[
                            {
                                "name":"ccna1",
                                "expirationDate":"1-1-2017"
                            },
                            {
                                "name":"ccna2",
                                "expirationDate":"2-2-2017"
                            }
                        ],
                        "languages": [{
                            "language": "english",
                            "proficiency": "master"
                        },
                            {
                                "language": "german",
                                "proficiency": "beginner"
                            }
                        ]
                    },
                    "friends":[{
                        "uid":1,
                        "name": "Paweł",
                        "name2": "Kłos"
                    },
                        {
                            "uid":3,
                            "name": "Wojciech",
                            "name2": "Cejerowski"
                        }]
                };

				function addObjectInArray(){
				    //iterate different objects in array of f.e jobexperience
					var line;
					var key;
					var value;
				    for(var i = 0, len = jsonProfile.jobexperience.length ; i < len ; i++){
				        //iterate keys in object (f.e. company, from, to)
                        for(var j = 0, len = Object.keys( jsonProfile.jobexperience[i] ).length ; j < len ; j++){
							//console.log(Object.keys(jsonProfile.jobexperience[i])[j]);
							line = $("<div>").addClass("line");
							key = $("<span>").addClass("key");
                            value = $("<span>").addClass("value");

                        }

					}
					var divTemplate = "<div class='objectInArray'>{1}</div>";
				    $("#jobexperiencelist").append("<div>");
				}
                addObjectInArray();

			</script>

		</div>
		</div>
		
		</form>
	</div>
	</div>
	<div class="footer"></div>
	</div>
</body>

<script>
	//TODO: Group this code with other code, For now it is here for clarity purposes
				//List capability script
				//TMP command: $("<div>").html( $("<div>").html("hehe") ).appendTo(".objectInArray")


	function updateProfile( json){
        $("#name").text(json.name);
        $("#name2").text(json.name2);
        $("#age").text(json.age);
        $("#tel").text(json.tel);
        $("#address").text(json.address);
        $("#jobexperience").text(json.jobexperience);
        $("#schools").text(json.schools);
        $("#skills").text(json.skills);
        $("#intrests").text(json.intrests);
        json.languages.forEach(function (value) {
            $("#languages").append( value['language'] + " with proficiency: " +value["proficiency"] + "<br>" );
        });
	}
	$("#saveBtn").on("click", function(){
		jsonProfile.name = $("#name").val();
        jsonProfile.name2 = $("#name2").val();
        jsonProfile.age = $("#age").val();
        jsonProfile.tel = $("#tel").val();
        jsonProfile.address = $("#address").val();
        jsonProfile.jobexperience = $("#jobexperience").val().split(",");
        jsonProfile.schools = $("#schools").val().split(",");
        jsonProfile.skills = $("#skills").val().split(",");
        jsonProfile.intrests = $("#intrests").val().split(",");


	});
	
	function BtnDisplay(){
	document.getElementById("searchBtn").style.display="block";}
	function BtnHide(){
	document.getElementById("searchBtn").style.display="none";}

    updateProfile(jsonProfile);
	
	 /*var settings = {

        "crossDomain": true,
        "url": "https://reqres.in/api/users/3",
        "method": "GET",
        "headers": {
            "cache-control": "no-cache",
            "postman-token": "0554329c-c2fa-1524-9653-fc44f2a7c20c"
        }
    }

    $.ajax(settings).done(function (response) {
        console.log(response);
    });*/

    var allUsers = [{
        "uid":2,
        "name": "Krzysztof",
        "name2": "Widacki",
        "email": "krzysztofwidacki@gmail.com",

    },{
        "uid":1,
        "name": "Paweł",
        "name2": "Kłos",
        "email": "98asdjwofapixjc@gmail.com",

    },{
        "uid":3,
        "name": "Wojciech",
        "name2": "Cejerowski",
        "email": "someCejerowski@gmail.com",

    },{
        "uid":4,
        "name": "Krzysztof",
        "name2": "Orecki",
        "email": "some@gmail.com",

    },
	];
    //var result = $.grep(allUsers, function(e){ return e.name == "Krzysztof"; });
    function searchUser(value){
        var result = $.grep(allUsers, function(e){
            var isFound = ((e.name.toLowerCase() +" "+ e.name2.toLowerCase() + " " + e.email.toLowerCase()).match(new RegExp(value, 'gi')));
            return isFound;
        });
		//console.log(result);
		var list ="";
        result.forEach(function(val){
            list += "<a href='user/" + val.uid + "'>" + val.name +" "+ val.name2 + "</a>";

		});
        $("#searchResults-container").html(list);

	}



	$("#searchBtn").on("click", function(){
        //console.log(result);
        searchUser($("#searchInput").val());
	});
    $("#searchInput").on("keyup", function(){
        //console.log(result);
        searchUser($("#searchInput").val());
    });

</script>
</html>